#!/bin/bash
#
# /usr/local/bin/update-route53-dns
#
# Generated by Chef for <%= node[:fqdn] %>
#

#config start
TTL="<%= node['dns']['ttl'] %>"
ZONE="<%= node['dns']['zone'] %>"
SERVERNAME=$(echo $HOSTNAME | sed "s/\.airmotion\.de//g")
#config end

#get ip address
IP_ADDRESS=$(ec2metadata | grep 'public-ipv4' | cut -d ' ' -f 2)
#create recored
cli53 rrcreate $ZONE $SERVERNAME "A" $IP_ADDRESS --ttl $TTL --replace